private _points = [[6548.2,1082.61,0.0169716],[6547.68,1082.61,0.0137634],[6546.4,1082.6,0.0157394],[6541.32,1082.59,0.0160217],[6531.07,1082.61,0.0153275],[6512.78,1082.64,0.0161285],[6487.66,1082.64,0.0163765],[6460.32,1082.57,0.013134],[6433.79,1082.58,0.0195885],[6403.96,1082.68,0.0161972],[6369.94,1082.79,0.0215378],[6337.25,1082.84,0.0187416],[6306.99,1082.42,0.0152664],[6278.56,1081.76,0.0167389],[6252.61,1081.12,0.00822449],[6225.91,1080.71,0.0391998],[6197.82,1079.88,-0.010643],[6171.16,1078.15,0.0397644],[6145.84,1076.99,0.0388756],[6123.62,1076.54,0.0157967],[6103.44,1076.24,0.0172462],[6079.2,1075.97,0.0114937],[6051.7,1076.77,0.0217552],[6026.25,1078.2,0.0467644],[6002.61,1078.54,0.057415],[5976.09,1078.18,0.00995636],[5946.01,1077.76,0.017498],[5914.56,1077.55,-0.0102844],[5885.5,1077.94,0.0847473],[5858.64,1078.5,0.0469589],[5833.65,1077.31,0.105152],[5812.7,1076.08,-0.0147858],[5793.17,1075.86,0.0606499],[5774.94,1075.84,0.0515671],[5752.25,1075.89,-0.00537109],[5725.6,1075.91,0.0453835],[5701.49,1075.69,0.0256348],[5678.5,1075.5,0.0395737],[5650.32,1075.23,0.0218086],[5616.82,1074.66,0.0343781],[5583.52,1073.87,0.00571823],[5550.86,1073.04,-0.00224686],[5520.66,1072.26,0.0410881],[5494.27,1071.79,0.0195923],[5479.97,1071.28,0.0624886],[5469.69,1070.9,0.061882],[5454.29,1070.12,0.0356445],[5439.69,1069.71,0.0173569],[5427.35,1070.73,0.0558167],[5411.86,1071.49,0.11248],[5396.08,1071.3,0.0960503],[5379.74,1070.95,0.076107],[5364.34,1071.24,0.0917358],[5349.88,1071.19,0.292427],[5332.31,1070.14,0.335442],[5314.91,1068.73,0.0430908],[5297.47,1067.58,0.013195],[5282.41,1067.59,0.0222645],[5267.63,1067.76,0.0323658],[5252.17,1068.31,0.0107918],[5236.83,1067.81,0.0217915],[5221.47,1066.84,0.0414867],[5205.05,1065.99,0.0259933],[5192.08,1065.56,0.00840569],[5180.9,1066.83,0.0684261],[5169.15,1070.01,0.0161209],[5159.83,1075.97,0.0291328],[5154.51,1084.9,0.0256844],[5150.86,1101.64,0.0218182],[5145.45,1125.43,0.0176277],[5139.97,1154.73,-0.00356483],[5135.39,1189.7,0.0116272],[5129.82,1227.95,0.00968933],[5118.66,1265.46,0.046669],[5111.41,1292.54,0.0212612],[5109.11,1311.94,0.0190697],[5106.8,1336.19,0.0140896],[5103.25,1359.61,0.0213966],[5100.62,1374.31,0.0863533],[5099.28,1381.22,0.103777],[5098.59,1387.54,0.118496],[5097.27,1393.48,0.0206051],[5093.53,1398.01,0.0326042],[5086.99,1400.82,0.0497971],[5078.3,1400.56,0.0597992],[5068.9,1400.3,0.0531979],[5055.34,1401.75,0.0263157],[5034.18,1407.11,0.018507],[5006.92,1413.77,0.0138035],[4974.82,1420.81,0.00446892],[4938.65,1427.31,0.0160522],[4903.04,1432.48,0.0187759],[4868.05,1437.7,0.0148239],[4834.25,1442.36,-0.00670242],[4802.05,1444.38,0.0148544],[4771.12,1444.94,0.0136967],[4742.79,1444.81,0.0135536],[4715.72,1444.53,0.0170803],[4696.09,1445.37,0.0167332],[4684.02,1449.33,0.0233059],[4668.77,1456.77,0.00390244],[4650.07,1468.36,0.0125732],[4630.7,1476.92,0.019537],[4611.01,1483.67,0.0174198],[4593.88,1486.74,0.0119076],[4582.68,1484.27,0.0155907],[4568.5,1476.92,0.0167522],[4559.83,1466.54,0.0207672],[4553.22,1459.34,0.0173836],[4541.35,1451.24,0.0195808],[4522.43,1440.78,0.0150566],[4496.73,1430.08,0.0148983],[4467.64,1418.91,0.0108242],[4440.9,1411.41,0.0321426],[4414.54,1409.91,0.0187759],[4383.84,1414.31,0.0206299],[4348.96,1421.55,0.0056076],[4311.6,1429.25,0.0237465],[4281.54,1427.64,0.0318375],[4268.57,1421.34,0.0107555],[4261.21,1421.63,0.0176792],[4256.13,1426.01,0.00697327],[4246.2,1428.72,0.00186634],[4228.66,1432.06,-0.00753975],[4205.24,1430.68,0.00118542],[4187.87,1417.34,-0.0308199],[4177.1,1407.83,0.0157356],[4166.4,1401.66,-0.00199986],[4149.82,1391.15,-0.0028286],[4131.09,1374.44,-0.00309086],[4109.11,1354.65,-0.00432205],[4082.58,1331.3,-0.000452995],[4053.78,1306.17,-0.000929832],[4022.77,1279.1,-0.0053463],[3990.06,1250.49,-0.00498772],[3955.53,1219.61,-0.00371933],[3919.19,1186.69,-0.00540924],[3881.3,1152.4,-0.000989914],[3842.07,1116.88,-0.00295258],[3801.44,1080.07,-0.00307655],[3758.55,1041.19,-0.00392151],[3714.81,1001.49,-0.00530815],[3670.28,961.059,-0.0083847],[3625.04,919.956,-8.7738e-005],[3578.42,877.563,-0.00862312],[3530.84,834.283,-0.00475311],[3482.77,790.537,-0.00422668],[3433.88,746.018,-0.00580788],[3383.46,699.968,-0.0041256],[3334.8,650.912,-0.00118446],[3289.52,598.336,0.00102043],[3246.28,544.453,-0.00590897],[3203.38,489.323,0.000354767],[3160.37,433.325,-0.00800323],[3117.5,374.989,0.0017395],[3080.4,313.042,-0.00682449],[3048.04,247.986,-0.00768852],[3010.96,183.838,-0.0138302],[2974.34,123.871,-0.0141277],[2953.64,76.3168,0],[2946.45,51.8373,0.0173588],[2939.47,46.8105,-0.00524902],[2936.25,44.6884,-0.00494385]];
private _dir = 270;

private _types = 
[
    ["Redd_Tank_LKW_leicht_gl_Wolf_Flecktarn_Moerser", getPos bwConvoyPos_1],
    ["Redd_Marder_1A5_Flecktarn", getPos bwConvoyPos_2],
    ["Redd_Tank_Fuchs_1A4_Pi_Flecktarn", getPos bwConvoyPos_3],
    ["Redd_Tank_Fuchs_1A4_Pi_Flecktarn", getPos bwConvoyPos_4],
    ["Redd_Tank_Fuchs_1A4_Pi_Flecktarn", getPos bwConvoyPos_5],
    ["Redd_Tank_Fuchs_1A4_San_Flecktarn", getPos bwConvoyPos_6],
    ["Redd_Marder_1A5_Flecktarn", getPos bwConvoyPos_7],
    ["Redd_Tank_LKW_leicht_gl_Wolf_Flecktarn_Moerser", getPos bwConvoyPos_8]
];




private _convoy = [];

{   
    _x params ["_classname", "_position"];

    private _veh = ([_position,_dir,_classname,west] call BIS_fnc_spawnVehicle) select 0;

    _convoy pushBack _veh;
  
} forEach _types;

sleep 3;

(_convoy select 0) setDriveOnPath _points;

for [{_i=0},{_i<count _convoy},{_i=_i+1}] do {
    [{
        params ["_vehicles","_handle"];
        _vehicles params ["_leader","_thisVeh","_follower","_vehicle1"];

        if (isNull (driver _vehicle1) && {speed _thisVeh < 1}) exitWith {
            [_handle] call CBA_fnc_removePerFrameHandler;
        };

        private _distFront = _thisVeh distance _leader;
        private _distBack = _thisVeh distance _follower;

        if (!isNull _leader) then {
            if (_distFront < 5) then {
                _thisVeh limitSpeed 0.5;
            } else {
                _thisVeh setDriveOnPath [getPos _thisVeh,_thisVeh getPos [0.8 * _distFront,_thisVeh getDir _leader]];
                private _speedLimit = if (_distFront > 15) then {
                    if (_distFront < 20) then {30} else {32}
                } else {28};
                _thisVeh limitSpeed _speedLimit;
            };
        };

        if (!isNull _follower && {_distBack > 50}) then {
            _thisVeh limitSpeed 0.5;
        } else {
            if (isNull _leader) then {
                _thisVeh limitSpeed 30;
            };
        };

    },0.5,[_convoy param [_i-1,objNull],_convoy select _i,_convoy param [_i+1,objNull]],_convoy select 0] call CBA_fnc_addPerFrameHandler;
};
